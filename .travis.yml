language: node_js

jobs:
  include:
    - stage: spec tests ðŸ‘©ðŸ½â€ðŸ’»
      script: npm run test:specs
      node_js: lts/*

    - stage: unit tests ðŸ‘©ðŸ½â€ðŸ’»
      script: npm run test:unit
      node_js: lts/*

    - stage: integration tests ðŸ‘©ðŸ½â€ðŸ’»
      script: npm run test:integration
      node_js: v0.10
    - node_js: v4
    - node_js: lts/*
    - node_js: node

    - stage: lint âœ¨
      script: npm run test:lint
      node_js: lts/*

    - stage: minify ðŸ—œï¸
      script: |
        npm run build
        if ! git diff --quiet; then
          git config --global user.email "travis@travis-ci.org"
          git config --global user.name "Travis-CI"
          git config credential.helper "store --file=.git/credentials"
          echo "https://${GITHUB_TOKEN}:@github.com" > .git/credentials
          git commit -am 'minify [skip ci]'
          git push origin HEAD:${TRAVIS_BRANCH}
        fi
      node_js: lts/*
      if: branch = master AND type = push

cache:
  directories:
    - node_modules
